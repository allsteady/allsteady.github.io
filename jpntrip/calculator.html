<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="apple-mobile-web-app-capable" content="yes"/>
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<title>환율계산기</title>

	<link rel="stylesheet" href="http://code.jquery.com/mobile/git/jquery.mobile-git.css">
	<script src="http://code.jquery.com/jquery-1.10.2.js"></script>
	<script>
		window._currencyDataLoad = false;
		window._currencyPageLoad = false;
		$( document ).bind(" dataload pageshow ", function ( event ) {
			if ( event.type === "dataload" ) {
				window._currencyDataLoad = true;
			}
			if ( event.type === "pageshow" ) {
				window._currencyPageLoad = true;
			}
			if ( window._currencyDataLoad && window._currencyPageLoad  ) {
				$( "#fromN" ).text( window.currencyData.from );
				$( "#toN" ).text( window.currencyData.to );
				$( "#currency" ).val( window.currencyData.rate );
			}

		}).on("click", "#calc", function ( event ) {
			var cash = parseInt( $( "#fromA" ).val() );
			console.log ( "%s * %s = %s  ",cash,   window.currencyData.rate , ( window.currencyData.rate  * cash ));
			$( "#toA" ).val( cash * window.currencyData.rate  );
		});
		$.ajax ({
			url : "http://rate-exchange.appspot.com/currency?from=JPY&to=KRW",
			dataType: "jsonp",
			crossDomain: true,
			error : function ( jqXHR, textStatus, errorThrown ) {
				console.log (" error....." + errorThrown.message);
			},
			success : function ( data ) {
				console.log (" success..... ("+data.from+" -> "+data.to+"): " + data.rate );
				window.currencyData = data;
				$( document ).trigger( "dataload" );
			}
		})
	</script>
	<script type="text/javascript" src="http://code.jquery.com/mobile/git/jquery.mobile-git.js"></script>

</head>
<body>
	<div data-role="page">
		<div data-role="header">
			<h1> Calculator </h1>
		</div>
		<div data-role="content">
			<div data-role="filedcontains" style="margin: 1em 0;">
				<label for="currency" class="select my-label">환율</label>
				<input id="currency" name="currency" type="number" disabled id="displayControl" style="text-align: right;" value="0" />
			</div>

			<div data-role="filedcontain"  style="margin: 1em 0;">
				<label for="fromA" id="fromN" class="select my-label">환율</label>
				<input id="fromA" name="fromA" type="number"  id="displayControl" style="text-align: right;" value="0" />
			</div>
			<div data-role="filedcontain"  style="margin: 1em 0;">
				<label for="toA" id="toN" class="select my-label">환율</label>
				<input id="toA" name="toA" type="number"  id="displayControl" style="text-align: right;" value="0" disabled />
			</div>

			
			<div class="ui-grid-b">
				<div class="ui-block-a"><button data-theme="a" id="keyC" data-rockncoder-tag="C" data-mini="true">C</button></div>
				<div class="ui-block-b"><button data-theme="a" id="keyCe" data-rockncoder-tag="CE" data-mini="true">CE</button></div>
				<div class="ui-block-c"><button data-theme="a" id="calc" data-rockncoder-tag="CE" data-mini="true">Calc</button></div>
			</div>
			<div class="ui-grid-c" data-mini="true">
				<div class="ui-block-a"><button data-theme="a" id="key7" data-rockncoder-tag="7">7</button></div>
				<div class="ui-block-b"><button data-theme="a" id="key8" data-rockncoder-tag="8" >8</button></div>
				<div class="ui-block-c"><button data-theme="a" id="key9" data-rockncoder-tag="9" >9</button></div>
				<div class="ui-block-d"><button data-theme="b" id="keyDivide" >/</button></div>
				<div class="ui-block-a"><button data-theme="a" id="key4" data-rockncoder-tag="4" >4</button></div>
				<div class="ui-block-b"><button data-theme="a" id="key5" data-rockncoder-tag="5" >5</button></div>
				<div class="ui-block-c"><button data-theme="a" id="key6" data-rockncoder-tag="6" >6</button></div>
				<div class="ui-block-d"><button data-theme="b" id="keyMultiply" >*</button></div>
				<div class="ui-block-a"><button data-theme="a" id="key1" data-rockncoder-tag="1" >1</button></div>
				<div class="ui-block-b"><button data-theme="a" id="key2" data-rockncoder-tag="2" >2</button></div>
				<div class="ui-block-c"><button data-theme="a" id="key3" data-rockncoder-tag="3" >3</button></div>
				<div class="ui-block-d"><button data-theme="b" id="keySubtract" >-</button></div>
				<div class="ui-block-a"><button data-theme="b" id="keyDecimalPoint" data-rockncoder-tag="." data-mini="true">.</button></div>
				<div class="ui-block-b"><button data-theme="a" id="key0" data-rockncoder-tag="0" data-mini="true">0</button></div>
				<div class="ui-block-c"><button data-theme="b" id="keyEquals" data-mini="true">=</button></div>
				<div class="ui-block-d"><button data-theme="b" id="keyAdd" data-mini="true">+</button></div>
			</div>
		</div>
	</div>
</body>